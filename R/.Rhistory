}
}
test_set<-test_set[order(test_set$AgentId),]
finalset <- rbind(finalset,test_set)
}
}
test_data<-subset(PersonsSuburb,PersonsSuburb$Gender=="Male")
test_data<-subset(test_data,test_data$MainAct=="Casual Work"|test_data$MainAct=="Full-time Work"|test_data$MainAct=="Part-time Work")
test_data$MainAct <- as.factor(as.character(test_data$MainAct))
test_data$WorkCat <- as.numeric(test_data$MainAct)
test_data <-test_data[,c(1,2,3,12,14)]
test_data$Rand <- runif(nrow(test_data), 0, 100)
train_data<-subset(Wrk,Wrk$SEX=="Male")
train_data$WorkCat <- as.numeric(train_data$MAINACT)
train_data2 <- subset(train_data,train_data$WorkCat==1)
test_data2 <- subset(test_data,test_data$WorkCat==1)
a = 0
for (a in 0:7){
training_set <- subset(train_data2,train_data2$AgeGroup_RW==a)
test_set <- subset(test_data2,test_data2$AgeGroup==a)
test_set <- test_set[order(test_set$Rand),]
WorkCat<-as.data.frame(cumsum(wtd.table(training_set$ANZSCO1,weights = training_set$CW_ADPERSWGT_LGA))/sum(wtd.table(training_set$ANZSCO1,weights = training_set$CW_ADPERSWGT_LGA))*100)
WorkCat$Act <- rownames(WorkCat)
rownames(WorkCat)<-c()
WorkCat$Wt <- WorkCat$`cumsum(wtd.table(training_set$ANZSCO1, weights = training_set$CW_ADPERSWGT_LGA))/sum(wtd.table(training_set$ANZSCO1, weights = training_set$CW_ADPERSWGT_LGA)) * 100`
WorkCat <- WorkCat[,c(-1)]
j=1
i=1
for (i in 1:13){
while (test_set$Rand[j]<WorkCat$Wt[i]&&!is.na(test_set$Rand[j])){
test_set$MainAct[j] <- WorkCat$Act[i]
j=j+1
}
}
test_set<-test_set[order(test_set$AgentId),]
finalset <- rbind(finalset,test_set)
}
b=2
for (b in 2:3){
train_data2 <- subset(train_data,train_data$WorkCat==b)
test_data2 <- subset(test_data,test_data$WorkCat==b)
a = 0
for (a in 0:7){
training_set <- subset(train_data2,train_data2$AgeGroup_RW==a)
test_set <- subset(test_data2,test_data2$AgeGroup==a)
test_set <- test_set[order(test_set$Rand),]
WorkCat<-as.data.frame(cumsum(wtd.table(training_set$ANZSCO1,weights = training_set$CW_ADPERSWGT_LGA))/sum(wtd.table(training_set$ANZSCO1,weights = training_set$CW_ADPERSWGT_LGA))*100)
WorkCat$Act <- rownames(WorkCat)
rownames(WorkCat)<-c()
WorkCat$Wt <- WorkCat$`cumsum(wtd.table(training_set$ANZSCO1, weights = training_set$CW_ADPERSWGT_LGA))/sum(wtd.table(training_set$ANZSCO1, weights = training_set$CW_ADPERSWGT_LGA)) * 100`
WorkCat <- WorkCat[,c(-1)]
j=1
i=1
for (i in 1:13){
while (test_set$Rand[j]<WorkCat$Wt[i]&&!is.na(test_set$Rand[j])){
test_set$MainAct[j] <- WorkCat$Act[i]
j=j+1
}
}
test_set<-test_set[order(test_set$AgentId),]
finalset <- rbind(finalset,test_set)
}
}
names(formalsetWork)[2] <- "AGE"
names(formalsetWork)[3] <- "SEX"
formalsetWork$ANZSCO1 <- finalset$MainAct
Wrk <- Wrk[Wrk$ANZSCO1%in%formalsetWork$ANZSCO1,]
Wrk$ANZSCO1 <- as.factor(as.character(Wrk$ANZSCO1))
formalsetWork <- formalsetWork[order(formalsetWork$AgentId),]
formalsetWork$AgeGroup <- as.factor(formalsetWork$AgeGroup)
Wrk$workDuration <- as.numeric(Wrk$workDuration)
dataset2 <- Wrk[,c(114,116,11)]
dataset2$SEX = factor(dataset2$SEX,
labels = c(1, 2))
test_set <- formalsetWork[,c(2,3)]
test_set$SEX = factor(test_set$SEX,
labels = c(1, 2))
finalerr <- 1000
idealtrees = 0
line_reg = randomForest(x=dataset2[-3],y=dataset2$STARTIME,ntree = 100,weights = Wrk$CW_ADJTWWGT_LGA)
formalsetWork$STARTIME = predict(line_reg, test_set)
Wrk$workDuration <- as.numeric(Wrk$workDuration)
dataset2 <- Wrk[,c(114,131,77)]
dataset2$ANZSCO1 = factor(dataset2$ANZSCO1,labels = c(1:nlevels(dataset2$ANZSCO1)))
test_set <- formalsetWork[,c(2,14)]
test_set$ANZSCO1 = factor(test_set$ANZSCO1,
labels = c(1: nlevels(dataset2$ANZSCO1)))
finalerr <- 100
idealtrees = 0
line_reg = randomForest(x=dataset2[-3],y=dataset2$workDuration,ntree = 100,weights = Wrk$CW_ADJTWWGT_LGA)
formalsetWork$workDuration = predict(line_reg, test_set)
test_data<-subset(formalsetWork,formalsetWork$SEX=="Female")
test_data <-test_data[,c(1,12)]
test_data$Rand <- runif(nrow(test_data), 0, 100)
train_data<-subset(Wrk,Wrk$SEX=="Female")
training_set <- subset(train_data,train_data$AgeGroup_RW==1)
test_set <- subset(test_data,test_data$AgeGroup==1)
test_set <- test_set[order(test_set$Rand),]
WorkCat<-as.data.frame(cumsum(wtd.table(training_set$JTWMODE,weights = training_set$CW_ADPERSWGT_LGA))/sum(wtd.table(training_set$JTWMODE,weights = training_set$CW_ADPERSWGT_LGA))*100)
WorkCat$Mode <- rownames(WorkCat)
rownames(WorkCat)<-c()
WorkCat$Wt <- WorkCat$`cumsum(wtd.table(training_set$JTWMODE, weights = training_set$CW_ADPERSWGT_LGA))/sum(wtd.table(training_set$JTWMODE, weights = training_set$CW_ADPERSWGT_LGA)) * 100`
WorkCat <- WorkCat[,c(-1)]
j=1
i=1
for (i in 1:10){
while (test_set$Rand[j]<WorkCat$Wt[i]&&!is.na(test_set$Rand[j])){
test_set$JTWMODE[j] <- WorkCat$Mode[i]
j=j+1
}
}
finalset <- test_set
a = 2
for (a in 2:7){
training_set <- subset(train_data,train_data$AgeGroup_RW==a)
test_set <- subset(test_data,test_data$AgeGroup==a)
test_set <- test_set[order(test_set$Rand),]
WorkCat<-as.data.frame(cumsum(wtd.table(training_set$JTWMODE,weights = training_set$CW_ADPERSWGT_LGA))/sum(wtd.table(training_set$JTWMODE,weights = training_set$CW_ADPERSWGT_LGA))*100)
WorkCat$Mode <- rownames(WorkCat)
rownames(WorkCat)<-c()
WorkCat$Wt <- WorkCat$`cumsum(wtd.table(training_set$JTWMODE, weights = training_set$CW_ADPERSWGT_LGA))/sum(wtd.table(training_set$JTWMODE, weights = training_set$CW_ADPERSWGT_LGA)) * 100`
WorkCat <- WorkCat[,c(-1)]
j=1
i=1
for (i in 1:13){
while (test_set$Rand[j]<WorkCat$Wt[i]&&!is.na(test_set$Rand[j])){
test_set$JTWMODE[j] <- WorkCat$Mode[i]
j=j+1
}
}
test_set<-test_set[order(test_set$AgentId),]
finalset <- rbind(finalset,test_set)
}
test_data<-subset(formalsetWork,formalsetWork$SEX=="Male")
test_data <-test_data[,c(1,12)]
test_data$Rand <- runif(nrow(test_data), 0, 100)
train_data<-subset(Persons,Persons$SEX=="Male")
a = 1
for (a in 1:7){
training_set <- subset(Wrk,Wrk$AgeGroup_RW==a)
test_set <- subset(test_data,test_data$AgeGroup==a)
test_set <- test_set[order(test_set$Rand),]
WorkCat<-as.data.frame(cumsum(wtd.table(training_set$JTWMODE,weights = training_set$CW_ADPERSWGT_LGA))/sum(wtd.table(training_set$JTWMODE,weights = training_set$CW_ADPERSWGT_LGA))*100)
WorkCat$Mode <- rownames(WorkCat)
rownames(WorkCat)<-c()
WorkCat$Wt <- WorkCat$`cumsum(wtd.table(training_set$JTWMODE, weights = training_set$CW_ADPERSWGT_LGA))/sum(wtd.table(training_set$JTWMODE, weights = training_set$CW_ADPERSWGT_LGA)) * 100`
WorkCat <- WorkCat[,c(-1)]
j=1
i=1
for (i in 1:13){
while (test_set$Rand[j]<WorkCat$Wt[i]&&!is.na(test_set$Rand[j])){
test_set$JTWMODE[j] <- WorkCat$Mode[i]
j=j+1
}
}
test_set<-test_set[order(test_set$AgentId),]
finalset <- rbind(finalset,test_set)
}
finalset <- finalset[order(finalset$AgentId),]
formalsetWork <- formalsetWork[order(finalset$AgentId),]
formalsetWork <- cbind(formalsetWork,finalset$JTWMODE)
names(formalsetWork)[17] <- "JTWMODE"
Wrk <- Wrk[Wrk$JTWMODE%in%formalsetWork$JTWMODE,]
Wrk$WorkCat <- as.factor(Wrk$WorkCat)
reg <- lm(Wrk$JTWDIST~Wrk$STARTIME+Wrk$SEX+Wrk$JTWMODE)
summary(reg)
dataset2 <- Wrk[,c(11,83,79)]
dataset2$JTWMODE = factor(dataset2$JTWMODE,
labels = c(1:nlevels(dataset2$JTWMODE)))
test_set <- formalsetWork[,c(15,17)]
test_set$JTWMODE = factor(test_set$JTWMODE,
labels = c(1:nlevels(dataset2$JTWMODE)))
finalerr <- 1000
idealtrees = 0
line_reg = randomForest(x=dataset2[-3],y=dataset2$JTWDIST,ntree = 100,weights = Wrk$CW_ADJTWWGT_LGA)
formalsetWork$JTWDIST = predict(line_reg, test_set)
Wrk$JTWSPEED <- (Wrk$JTWDIST/Wrk$JTWTravelTime)*60
reg <- lm(Wrk$JTWSPEED~Wrk$STARTIME+Wrk$SEX+Wrk$JTWMODE+Wrk$AGE)
summary(reg)
dataset2 <- Wrk[,c(11,83,186)]
dataset2$JTWMODE = factor(dataset2$JTWMODE,
labels = c(1:nlevels(dataset2$JTWMODE)))
test_set <- formalsetWork[,c(15,17)]
test_set$JTWMODE = factor(test_set$JTWMODE,
labels = c(1:nlevels(dataset2$JTWMODE)))
finalerr <- 100
idealtrees = 0
line_reg = randomForest(x=dataset2[-3],y=dataset2$JTWSPEED,ntree = 100,weights = Wrk$CW_ADJTWWGT_LGA)
formalsetWork$JTWSPEED = predict(line_reg, test_set)
# ggplot(Wrk,aes(x=Wrk$AgeGroup_RW,y=Wrk$STARTIME))+geom_boxplot()  + coord_cartesian(ylim=c(400,700))
# ggplot(formalsetWork,aes(x=formalsetWork$AgeGroup,y=formalsetWork$STARTIME))+geom_boxplot()
#
# ggplot(Wrk,aes(x=Wrk$JTWMODE,y=Wrk$JTWSPEED))+geom_boxplot() + coord_cartesian(ylim=c(0,30))
# ggplot(formalsetWork,aes(x=formalsetWork$JTWMODE,y=formalsetWork$JTWSPEED))+geom_boxplot()
#
# ggplot(Wrk,aes(x=Wrk$AgeGroup_RW,y=Wrk$workDuration))+geom_boxplot() + coord_cartesian(ylim=c(100,400))
# ggplot(formalsetWork,aes(x=formalsetWork$AgeGroup,y=formalsetWork$workDuration))+geom_boxplot()
formalsetWork$JTWTIME <- formalsetWork$JTWDIST/formalsetWork$JTWSPEED * 60
formalsetWork$ReachWorkTme <- formalsetWork$STARTIME + formalsetWork$JTWTIME
formalsetWork$LeaveWorkTime <- formalsetWork$ReachWorkTme+formalsetWork$workDuration
Edu <- subset(SingEdu, SingEdu$MAINACT=="Primary School"|SingEdu$MAINACT=="Secondary School"|SingEdu$MAINACT=="Full-time TAFE/Uni"|SingEdu$MAINACT=="Part-time TAFE/Uni")
Edu$AgeGroup_RW <- as.factor(Edu$AgeGroup_RW)
Edu$MAINACT<-as.factor(as.character(Edu$MAINACT))
formalsetEdu <- subset(PersonsSuburb,PersonsSuburb$MainAct=="Primary School"|PersonsSuburb$MainAct=="Secondary School"|PersonsSuburb$MainAct=="Full-time TAFE/Uni"|PersonsSuburb$MainAct=="Part-time TAFE/Uni")
names(formalsetEdu)[2] <- "AGE"
names(formalsetEdu)[3] <- "SEX"
names(formalsetEdu)[13] <- "MAINACT"
formalsetEdu$ANZSCO1 <- formalsetEdu$MAINACT
Edu <- subset(Edu, Edu$JTEMODE!="Other")
Edu$JTEMODE <- as.factor(as.character(Edu$JTEMODE))
formalsetEdu <- formalsetEdu[order(formalsetEdu$AgentId),]
formalsetEdu$AgeGroup <- as.factor(formalsetEdu$AgeGroup)
dataset2 <- Edu[,c(114,128,11)]
dataset2$MAINACT = factor(dataset2$MAINACT,
labels = c(1:4))
test_set <- formalsetEdu[,c(2,13)]
test_set$MAINACT = factor(test_set$MAINACT,
labels = c(1:4))
finalerr <- 1000
idealtrees = 0
line_reg = randomForest(x=dataset2[-3],y=dataset2$STARTIME,ntree = 100,weights = Edu$CW_ADJTEWGT_LGA)
formalsetEdu$STARTIME = predict(line_reg, test_set)
# ggplot(Edu,aes(x=Edu$MAINACT,y=Edu$STARTIME,fill=Edu$AgeGroup_RW))+geom_boxplot() +coord_cartesian(ylim=c(400,700))
# ggplot(formalsetEdu,aes(x=formalsetEdu$MAINACT,y=formalsetEdu$STARTIME,fill=formalsetEdu$AgeGroup))+geom_boxplot()
test_data<-subset(formalsetEdu,formalsetEdu$SEX=="Female")
test_data <-test_data[,c(1,12)]
test_data$Rand <- runif(nrow(test_data), 0, 100)
train_data<-subset(Edu,Edu$SEX=="Female")
training_set <- subset(train_data,train_data$AgeGroup_RW==0)
test_set <- subset(test_data,test_data$AgeGroup==0)
test_set <- test_set[order(test_set$Rand),]
EduCat<-as.data.frame(cumsum(wtd.table(training_set$JTEMODE,weights = training_set$CW_ADPERSWGT_LGA))/sum(wtd.table(training_set$JTEMODE,weights = training_set$CW_ADPERSWGT_LGA))*100)
EduCat$Mode <- rownames(EduCat)
rownames(EduCat)<-c()
EduCat$Wt <- EduCat$`cumsum(wtd.table(training_set$JTEMODE, weights = training_set$CW_ADPERSWGT_LGA))/sum(wtd.table(training_set$JTEMODE, weights = training_set$CW_ADPERSWGT_LGA)) * 100`
EduCat <- EduCat[,c(-1)]
j=1
i=1
for (i in 1:13){
while (test_set$Rand[j]<EduCat$Wt[i]&&!is.na(test_set$Rand[j])){
test_set$JTEMODE[j] <- EduCat$Mode[i]
j=j+1
}
}
finalset <- test_set
a = 1
for (a in 1:7){
training_set <- subset(train_data,train_data$AgeGroup_RW==a)
test_set <- subset(test_data,test_data$AgeGroup==a)
test_set <- test_set[order(test_set$Rand),]
EduCat<-as.data.frame(cumsum(wtd.table(training_set$JTEMODE,weights = training_set$CW_ADPERSWGT_LGA))/sum(wtd.table(training_set$JTEMODE,weights = training_set$CW_ADPERSWGT_LGA))*100)
EduCat$Mode <- rownames(EduCat)
rownames(EduCat)<-c()
EduCat$Wt <- EduCat$`cumsum(wtd.table(training_set$JTEMODE, weights = training_set$CW_ADPERSWGT_LGA))/sum(wtd.table(training_set$JTEMODE, weights = training_set$CW_ADPERSWGT_LGA)) * 100`
EduCat <- EduCat[,c(-1)]
j=1
i=1
for (i in 1:13){
while (test_set$Rand[j]<EduCat$Wt[i]&&!is.na(test_set$Rand[j])){
test_set$JTEMODE[j] <- EduCat$Mode[i]
j=j+1
}
}
test_set<-test_set[order(test_set$AgentId),]
finalset <- rbind(finalset,test_set)
}
test_data<-subset(formalsetEdu,formalsetEdu$SEX=="Male")
test_data <-test_data[,c(1,12)]
test_data$Rand <- runif(nrow(test_data), 0, 100)
train_data<-subset(Persons,Persons$SEX=="Male")
a = 1
for (a in 0:7){
training_set <- subset(Edu,Edu$AgeGroup_RW==a)
test_set <- subset(test_data,test_data$AgeGroup==a)
test_set <- test_set[order(test_set$Rand),]
EduCat<-as.data.frame(cumsum(wtd.table(training_set$JTEMODE,weights = training_set$CW_ADPERSWGT_LGA))/sum(wtd.table(training_set$JTEMODE,weights = training_set$CW_ADPERSWGT_LGA))*100)
EduCat$Mode <- rownames(EduCat)
rownames(EduCat)<-c()
EduCat$Wt <- EduCat$`cumsum(wtd.table(training_set$JTEMODE, weights = training_set$CW_ADPERSWGT_LGA))/sum(wtd.table(training_set$JTEMODE, weights = training_set$CW_ADPERSWGT_LGA)) * 100`
EduCat <- EduCat[,c(-1)]
j=1
i=1
for (i in 1:13){
while (test_set$Rand[j]<EduCat$Wt[i]&&!is.na(test_set$Rand[j])){
test_set$JTEMODE[j] <- EduCat$Mode[i]
j=j+1
}
}
test_set<-test_set[order(test_set$AgentId),]
finalset <- rbind(finalset,test_set)
}
finalset <- finalset[order(finalset$AgentId),]
formalsetEdu <- formalsetEdu[order(finalset$AgentId),]
formalsetEdu <- cbind(formalsetEdu,finalset$JTEMODE)
names(formalsetEdu)[16]<-"JTEMODE"
Edu <- Edu[Edu$JTEMODE %in% formalsetEdu$JTEMODE,]
reg <- lm(Edu$JTEDIST~Edu$STARTIME+Edu$SEX+Edu$JTEMODE)
summary(reg)
dataset2 <- Edu[,c(11,128,82,78)]
dataset2$JTEMODE = factor(dataset2$JTEMODE,
labels = c(1:nlevels(dataset2$JTEMODE)))
dataset2$MAINACT = factor(dataset2$MAINACT,
labels = c(1:4))
test_set <- formalsetEdu[,c(15,13,16)]
test_set$JTEMODE = factor(test_set$JTEMODE,
labels = c(1:nlevels(dataset2$JTEMODE)))
test_set$MAINACT = factor(test_set$MAINACT,
labels = c(1:4))
finalerr <- 1000
idealtrees = 0
line_reg = randomForest(x=dataset2[-4],y=dataset2$JTEDIST,ntree = 100,weights = Edu$CW_ADJTEWGT_LGA)
formalsetEdu$JTEDIST = predict(line_reg, test_set)
# ggplot(Edu,aes(x=Edu$MAINACT,y=Edu$JTEDIST,fill=Edu$AgeGroup_RW))+geom_boxplot() +coord_cartesian(ylim=c(0,25))
# ggplot(formalsetEdu,aes(x=formalsetEdu$MAINACT,y=formalsetEdu$JTEDIST,fill=formalsetEdu$AgeGroup))+geom_boxplot()
Edu$JTESPEED <- (Edu$JTEDIST/Edu$JTE_TravelTime)*60
reg <- lm(Edu$JTESPEED~Edu$STARTIME+Edu$SEX+Edu$JTEMODE+Edu$AGE)
summary(reg)
dataset2 <- Edu[,c(11,82,186)]
dataset2$JTEMODE = factor(dataset2$JTEMODE,
labels = c(1:nlevels(dataset2$JTEMODE)))
test_set <- formalsetEdu[,c(15,16)]
test_set$JTEMODE = factor(test_set$JTEMODE,
labels = c(1:nlevels(dataset2$JTEMODE)))
finalerr <- 1000
idealtrees = 0
line_reg = randomForest(x=dataset2[-3],y=dataset2$JTESPEED,ntree = 100,weights = Edu$CW_ADJTEWGT_LGA)
formalsetEdu$JTESPEED = predict(line_reg, test_set)
formalsetEdu$JTETIME <- formalsetEdu$JTEDIST/formalsetEdu$JTESPEED * 60
formalsetEdu$ReachEduTme <- formalsetEdu$STARTIME + formalsetEdu$JTETIME
JTE <- subset(Stops, Stops$DESTPURP1=="Education")
JFE <- subset(Stops, Stops$ORIGPURP1=="Education")
JTEperson <- subset(as.data.frame(table(JTE$PERSID)), as.data.frame(table(JTE$PERSID))$Freq == 1)
JFEperson <- subset(as.data.frame(table(JFE$PERSID)), as.data.frame(table(JFE$PERSID))$Freq == 1)
JTE <- JTE[JTE$PERSID %in% JTEperson$Var1,]
JFE <- JFE[JFE$PERSID %in% JFEperson$Var1,]
JTE$PERSID <- as.factor(as.character(JTE$PERSID))
JFE$PERSID <- as.factor(as.character(JFE$PERSID))
total <- merge(JTE,JFE,by.x = "PERSID", by.y = "PERSID")
total$eduDuration <- total$STARTIME.y-total$ARRTIME.x
EduPersons <- Persons[Persons$PERSID %in% total$PERSID,]
total <- merge(total,EduPersons,by.x = "PERSID", by.y = "PERSID")
dataset2total <- subset(total,total$MAINACT == "Primary School"|total$MAINACT=="Secondary School"|total$MAINACT == "Part-time TAFE/Uni"|total$MAINACT == "Full-time TAFE/Uni")
dataset2total$MAINACT <- as.factor(as.character(dataset2total$MAINACT))
dataset2 <- dataset2total[,c(195,209,188)]
test_set <- formalsetEdu[,c(2,13)]
dataset2$MAINACT = factor(dataset2$MAINACT,labels = c(1:4))
test_set$MAINACT = factor(test_set$MAINACT,labels = c(1:4))
finalerr <- 1000
idealtrees = 0
line_reg = randomForest(x=dataset2[-3],y=dataset2total$eduDuration,ntree = 100,weights = dataset2total$CW_ADJTEWGT_LGA)
formalsetEdu$eduDuration = predict(line_reg, test_set)
formalsetEdu$LeaveEduTime <- formalsetEdu$ReachEduTme+formalsetEdu$eduDuration
formalsetEdu <- formalsetEdu[c(1:15,21,16:20,22)]
formalset <- formalsetWork
names(formalset)[16]<-"MainActDuration"
names(formalset)[17]<-"JTMMODE"
names(formalset)[18]<-"JTMDIST"
names(formalset)[19]<-"JTMSPEED"
names(formalset)[20]<-"JTMTIME"
names(formalset)[21]<-"ReachMainAct"
names(formalset)[22]<-"LeaveMainAct"
temp <- formalsetEdu
names(temp)[16]<-"MainActDuration"
names(temp)[17]<-"JTMMODE"
names(temp)[18]<-"JTMDIST"
names(temp)[19]<-"JTMSPEED"
names(temp)[20]<-"JTMTIME"
names(temp)[21]<-"ReachMainAct"
names(temp)[22]<-"LeaveMainAct"
names(temp)[13]<-"MainAct"
formalset <- rbind(formalset,temp)
formalset$JTMMODE <- as.factor(as.character(formalset$JTMMODE))
traindata <- subset(Trips, (Trips$ORIGPURP1=="Work Related"|Trips$ORIGPURP1=="Education")&Trips$DESTPURP1=="At or Go Home")
traindata$Speed <- traindata$CUMDIST/traindata$TRAVTIME*60
dataset2 <- traindata[,c(8,31,91)]
dataset2$LINKMODE = factor(dataset2$LINKMODE,
labels = c(1:nlevels(dataset2$LINKMODE)))
test_set <- formalset[,c(15,17)]
test_set$LINKMODE = factor(test_set$JTMMODE,
labels = c(1:nlevels(dataset2$LINKMODE)))
test_set <- test_set[,-2]
finalerr <- 1000
idealtrees = 0
dataset2$Speed[dataset2$Speed=="NaN"]<-0
line_reg = randomForest(x=dataset2[-3],y=dataset2$Speed,ntree = 20,weights = traindata$CW_ADJTEWGT_LGA)
formalset$JFMSpeed = predict(line_reg, test_set)
formalset$JFMTime <- formalset$JTMDIST/formalset$JFMSpeed * 60
formalset$ArrTime <- formalset$LeaveMainAct + formalset$JFMTime
MelbourneSynthPopulationWork <- rbind(MelbourneSynthPopulationWork,formalset)
MelbourneSynthPopulationNonWork <- rbind(MelbourneSynthPopulationNonWork, formalsetNonWork)
}
write.csv(MelbourneSynthPopulationWork,"MelbourneWork.csv")
write.csv(MelbourneSynthPopulationNonWork,"MelbourneNonWork.csv")
table(Persons$MAINACT)
table(Persons$MAINACT,Persons$AGEGROUP)
table(Persons$MAINACT,Persons$AgeGroup_RW)
View(Persons)
ggplot(Persons, aes(x=Persons$AgeGroup_RW,fill=Persons$SEX))+geom_bar()
View(as.da)
View(as.data.frame(table(Persons$MAINACT))
)
a <- (as.data.frame(table(Persons$MAINACT))
)
colnames(a)[1]="MainAct"
View(a)
ggplot(Persons, aes(x=Persons$MAINACT,fill=Persons$AgeGroup_RW))+geom_bar()
ggplot(Persons, aes(x=Persons$MAINACT,fill=Persons$AgeGroup_RW))+geom_bar()
ggplot(Persons, aes(x=Persons$MAINACT,fill=Persons$AgeGroup_RW))+geom_bar()
class(Persons$AgeGroup_RW)
ggplot(Persons, aes(x=Persons$MAINACT,fill=as.factor(Persons$AgeGroup_RW)))+geom_bar()
ggplot(Persons, aes(x=Persons$MAINACT,fill=as.factor(Persons$AgeGroup_RW)))+geom_bar()
ggplot(Persons, aes(x=Persons$MAINACT,fill=as.factor(Persons$AgeGroup_RW)))+geom_bar() + title("AgeGroup")
ggplot(Persons, aes(x=Persons$MAINACT,fill=as.factor(Persons$AgeGroup_RW)))+geom_bar() + ggtitle("AgeGroup")
ggplot(Persons, aes(x=Persons$MAINACT,fill=as.factor(Persons$AgeGroup_RW)))+geom_bar() + labs("AgeGroup")
---
title: "NonWork"
author: "Maitreya Wagh"
date: "6/3/2018"
output:
html_document:
keep_md: yes
---
```{r}
table(Persons$MAINACT,Persons$AgeGroup_RW)
```
```{r, fig.width=15, fig.height=10}
ggplot(Persons, aes(x=Persons$AgeGroup_RW,fill=Persons$SEX))+geom_bar()
ggplot(Persons, aes(x=Persons$MAINACT,fill=as.factor(Persons$AgeGroup_RW)))+geom_bar() + labs(x="AgeGroup")
```
ggplot(Persons, aes(x=Persons$MAINACT,fill=as.factor(Persons$AgeGroup_RW)))+geom_bar() + labs(x="AgeGroup")
ggplot(Persons, aes(x=Persons$AgeGroup_RW,fill=Persons$SEX))+geom_bar()
ggplot(Persons, aes(x=Persons$MAINACT,fill=as.factor(Persons$AgeGroup_RW)))+geom_bar() + labs(x="AgeGroup")
table(Person$ANZSCO1,Persons$AgeGroup_RW)
table(Persons$ANZSCO1,Persons$AgeGroup_RW)
View(table(Persons$ANZSCO1,Persons$AgeGroup_RW))
table(Persons$ANZSCO1,Persons$AgeGroup_RW)
wtd.table(Persons$ANZSCO1,Persons$AgeGroup_RW,weights=Persons$CW_ADPERSWGT_LGA)
table(Trips$LINKMODE)
Speed <- Trips$CUMDIST/Trips$TRAVTIME
ggplot(Trips, aes(x=Trips$LINKMODE,y=Speed)) + geom_boxplot()
ggplot(Trips, aes(x=Trips$LINKMODE,y=Speed)) + geom_boxplot()
ggplot(Trips, aes(x=Trips$LINKMODE,y=Speed)) + geom_boxplot()
Speed <- Trips$CUMDIST/Trips$TRAVTIME*60
ggplot(Trips, aes(x=Trips$LINKMODE,y=Speed)) + geom_boxplot()
ggplot(Trips, aes(x=Trips$LINKMODE,y=Speed)) + geom_boxplot()
ggplot(Trips, aes(x=Trips$LINKMODE,y=Speed,fill=Trips$TRAVELPERIOD)) + geom_boxplot()
ggplot(Trips, aes(x=Trips$LINKMODE,y=Speed,fill=Trips$TRAVELPERIOD)) + geom_boxplot()
ggplot(Trips, aes(x=Trips$LINKMODE,y=Speed,fill=Trips$TRAVELPERIOD)) + geom_boxplot()
ggplot(Trips, aes(x=Trips$LINKMODE,y=Speed,fill=Trips$TRAVELPERIOD)) + geom_boxplot()
ggplot(Trips, aes(x=Trips$LINKMODE,y=Speed,fill=Trips$TRAVELPERIOD)) + geom_boxplot()
ggplot(Trips, aes(x=Trips$LINKMODE,y=Speed,fill=Trips$TRAVELPERIOD)) + geom_boxplot()
ggplot(Trips, aes(x=Trips$LINKMODE,y=Speed,fill=Trips$TRAVELPERIOD)) + geom_boxplot()
ggplot(Wrk, aes(x=Wrk$JTWMODE,y=Wrk$STARTIME,fill=Wrk$SEX))+geom_boxplot()
ggplot(Wrk, aes(x=Wrk$JTWMODE,y=Wrk$STARTIME,fill=Wrk$SEX))+geom_boxplot()
ggplot(Wrk, aes(x=Wrk$JTWMODE,y=Wrk$STARTIME,fill=Wrk$SEX))+geom_boxplot()
ggplot(Wrk, aes(x=Wrk$SEX, y=Wrk$JTWDIST))+geom_boxplot()
ggplot(Wrk, aes(x=Wrk$SEX, y=Wrk$JTWDIST, fill=Wrk$AgeGroup_RW))+geom_boxplot()
ggplot(Wrk, aes(x=Wrk$AgeGroup_RW, y=Wrk$JTWDIST, fill=Wrk$SEX))+geom_boxplot()
ggplot(Wrk, aes(x=Wrk$AgeGroup_RW, y=Wrk$JTWDIST, fill=Wrk$SEX))+geom_boxplot() + coord_cartesian(ylim=c(1,100))
ggplot(Wrk, aes(x=Wrk$AgeGroup_RW, y=Wrk$workDuration, fill=Wrk$SEX))+geom_boxplot() + coord_cartesian(ylim=c(1,100))
ggplot(Wrk, aes(x=Wrk$AgeGroup_RW, y=Wrk$workDuration, fill=Wrk$SEX))+geom_boxplot()
ggplot(Wrk, aes(x=Wrk$AgeGroup_RW, y=Wrk$workDuration, fill=Wrk$SEX, weights=Wrk$CW_ADJTWWGT_LGA))+geom_boxplot()
ggplot(Wrk, aes(x=Wrk$AgeGroup_RW, y=Wrk$workDuration, fill=Wrk$SEX, weight=Wrk$CW_ADJTWWGT_LGA))+geom_boxplot()
ggplot(Edu, aes(x=Edu$AgeGroup_RW, y=Edu$STARTIME, fill=Edu$SEX, weight=Edu$CW_ADJTWWGT_LGA))+geom_boxplot()
ggplot(Edu, aes(x=Edu$AgeGroup_RW, y=Edu$STARTIME, fill=Edu$SEX, weight=Edu$CW_ADJTEWGT_LGA))+geom_boxplot()
ggplot(Edu, aes(x=Edu$AgeGroup_RW, y=Edu$JTEDIST, fill=Edu$SEX, weight=Edu$CW_ADJTEWGT_LGA))+geom_boxplot()
ggplot(Edu, aes(x=Edu$AGEGROUP, y=Edu$JTEDIST, fill=Edu$SEX, weight=Edu$CW_ADJTEWGT_LGA))+geom_boxplot()
ggplot(Trips, aes(x=Trips$LINKMODE,y=Speed,fill=Trips$TRAVELPERIOD)) + geom_boxplot()
ggplot(Edu, aes(x=Edu$AGEGROUP, y=Edu$JTEDIST, fill=Edu$SEX, weight=Edu$CW_ADJTEWGT_LGA))+geom_boxplot() + coord_cartesian(ylim = c(1,20))
ggplot(Edu, aes(x=Edu$AGEGROUP, y=Edu$JTEDIST, fill=Edu$SEX, weight=Edu$CW_ADJTEWGT_LGA))+geom_boxplot() + coord_cartesian(ylim = c(0,20))
list(colnames(PersonsSuburb))
table(Persons$HomeSA2)
ggplot(Wrk,aes(x=Wrk$HomeSA2, fill=Wrk$STARTIME))+geom_boxplot()
ggplot(Wrk,aes(x=Wrk$HomeSA2, y=Wrk$STARTIME))+geom_boxplot()
ggplot(Wrk,aes(x=Wrk$HomeSA2, y=Wrk$STARTIME))+geom_boxplot() + coord_cartesian(ylim = c(400,500))
table(Trips$main)
table(Trips$DESTPURP2)
wtd.table(Trips$DESTPURP2,weights = Trips$CW_ADTRIPWGT_LGA)
wtd.table(Trips$DESTPURP1,weights = Trips$CW_ADTRIPWGT_LGA)
View(wtd.table(Trips$DESTPURP1,weights = Trips$CW_ADTRIPWGT_LGA))
Sun <- subset(Trips, Trips$TRAVDOW == "Sunday")
NotSun <- subset(Trips,Trips$TRAVDOW != "Sunday")
ggplot(Trips$DESTPURP2)
table(Sun$DESTPURP2)
table(NotSun$DESTPURP2)
wtd.table(Sun$DESTPURP2,weights=6)
wtd.table(Sun$DESTPURP2,weights=c(6))
table(Trips$DESTPURP2)
table(Trips$DESTPURP1)
wtd.table(Sun$DESTPURP2,weights=Sun$CW_ADTRIPWGT_LGA)
wtd.table(NotSun$DESTPURP2,weights=NotSun$CW_ADTRIPWGT_LGA)
24946.34/6
wtd.table(Trips$DESTPURP2, weights = Trips$CW_ADTRIPWGT_LGA)
145730.90/7
ggplot(MelbourneSynthPopulationWork,aes(x=MelbourneSynthPopulationWork$ANZSCO1,fill=MelbourneSynthPopulationWork$MainActDuration)) + geom_boxplot()
ggplot(MelbourneSynthPopulationWork,aes(x=MelbourneSynthPopulationWork$ANZSCO1,y=MelbourneSynthPopulationWork$MainActDuration)) + geom_boxplot()
ggplot(MelbourneSynthPopulationWork,aes(x=MelbourneSynthPopulationWork$ANZSCO1,y=MelbourneSynthPopulationWork$MainActDuration)) + geom_boxplot()
ggplot(Wrk, aes(x=Wrk$ANZSCO1,y=Wrk$workDuration))+geom_boxplot()
library(ggplot2)
library(questionr)
library(smbinning)
library(varhandle)
library(randomForest)
PersonsSuburb <- read.csv("../../synthetic-population/data/melbourne-2016-population/melbourne/generated/SA2/population/persons.csv")
setwd("~/Desktop/matsim-melbourne/R")
PersonsSuburb <- read.csv("../../synthetic-population/data/melbourne-2016-population/melbourne/generated/SA2/population/persons.csv")
library(ggplot2)
library(questionr)
library(smbinning)
library(varhandle)
library(randomForest)
PersonsSuburb <- read.csv("../../synthetic-population/data/melbourne-2016-population/melbourne/generated/SA2/population/persons.csv")
